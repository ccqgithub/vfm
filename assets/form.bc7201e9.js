import{I as x,a0 as p,a1 as R,a2 as G,a3 as T,j as L,$ as z,f as H,p as Q,h as V,v as X,m as Y,J as S,R as tt}from"./app.93b797e6.js";var et=Object.defineProperty,st=Object.defineProperties,it=Object.getOwnPropertyDescriptors,P=Object.getOwnPropertySymbols,B=Object.prototype.hasOwnProperty,N=Object.prototype.propertyIsEnumerable,M=(s,t,e)=>t in s?et(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e,O=(s,t)=>{for(var e in t||(t={}))B.call(t,e)&&M(s,e,t[e]);if(P)for(var e of P(t))N.call(t,e)&&M(s,e,t[e]);return s},k=(s,t)=>st(s,it(t)),Z=(s,t)=>{var e={};for(var i in s)B.call(s,i)&&t.indexOf(i)<0&&(e[i]=s[i]);if(s!=null&&P)for(var i of P(s))t.indexOf(i)<0&&N.call(s,i)&&(e[i]=s[i]);return e};const rt=s=>{const t="{{name}} is not alphabetical";return typeof s!="string"?t:/^[a-zA-Z]*$/.test(s)?"":t},at=s=>{const t="{{name}} must be alpha-numeric";return typeof s!="string"&&typeof s!="number"?t:/^[a-zA-Z0-9]*$/.test(`${s}`)?"":t},nt=s=>{const t="{{name}} must be decimal";return typeof s!="string"&&typeof s!="number"?t:/^[-]?\d*(\.\d+)?$/.test(`${s}`)?"":t},lt=/^(?:[A-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[A-z0-9!#$%&'*+/=?^_`{|}~-]+)*|"(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21\x23-\x5b\x5d-\x7f]|[\x01-\x09\x0b\x0c\x0e-\x7f])*")@(?:(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9]{2,}(?:[a-z0-9-]*[a-z0-9])?|\[(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?|[a-z0-9-]*[a-z0-9]:(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21-\x5a\x53-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])+)\])$/i,ot=s=>{const t="{{name}} is not a valid email address";return typeof s!="string"?t:lt.test(s)?"":t},ut=s=>{const t="{{name}} is not an integer";return typeof s!="string"&&typeof s!="number"?t:/(^[0-9]*$)|(^-[0-9]+$)/.test(`${s}`)?"":t},dt=s=>{const t="{{name}} is not a valid IP address";if(typeof s!="string")return t;const e=s.split(".");return e.length===4&&e.every(ct)?"":t},ct=s=>{if(s.length>3||s.length===0||s[0]==="0"&&s!=="0"||!s.match(/^\d+$/))return!1;const t=+s;return t>=0&&t<=255},ht=s=>{const t="{{name}} is not a valid MAC Address";if(typeof s!="string")return t;const e=":",i=s.split(e);return(i.length===6||i.length===8)&&i.every(ft)?"":t},ft=s=>s.toLowerCase().match(/^[0-9a-f]{2}$/),vt=s=>{const t="{{name}} must be numeric";return typeof s!="string"&&typeof s!="number"?t:/^-?\d*(\.\d+)?$/.test(`${s}`)?"":t},W={alpha:rt,alphaNum:at,decimal:nt,email:ot,integer:ut,ipAddress:dt,macAddress:ht,numeric:vt},I=(s,t,e)=>{const i=t.split(".");let r=s;for(;i.length&&typeof r=="object"&&r!==null;){const a=i.shift();i.length===0?r[a]=e:(typeof r[a]!="object"||r[a]===null)&&(r[a]=/^\d+$/.test(a)?[]:{}),r=r[a]}},g=(s,t)=>{const e=t.split(".");let i=s;for(;e.length&&i;){const r=e.shift();i=typeof i=="object"&&i!==null?i[r]:void 0}return i},C=(s,t)=>{const e=t.split(".");let i=s;for(;e.length&&typeof i=="object"&&i!==null;){const r=e.shift();e.length===0?Array.isArray(i)?/^\d+$/.test(r)&&i.splice(Number(r),1):delete i[r]:i=i[r]}},q=(s,t,e=!0)=>{const i=Object.keys(s),r=Object.keys(t),a=i.filter(n=>!r.includes(n));e&&a.forEach(n=>{delete s[n]}),r.forEach(n=>{typeof s[n]=="object"&&!Array.isArray(s[n])&&s[n]!==null&&typeof t[n]=="object"&&!Array.isArray(t[n])&&t[n]!==null?q(s[n],t[n],e):s[n]=t[n]})},D=s=>{const t=[];let e=null;const i=s(a=>{t.push(a)}),r=new Promise((a,n)=>{e=a,i.then(a,n)});return r.cancel=()=>{e==null||e(""),t.forEach(a=>a())},r},j=[String,Number,Boolean,Symbol,Array,Object],pt=(s,t,e)=>D(async i=>{if(s.required&&!t&&t!==0||s.requiredLength&&(typeof(t==null?void 0:t.length)!="number"||t.length<=0))return"{{name}} is required";if(s.minLength!==void 0&&(typeof(t==null?void 0:t.length)!="number"||t.length<s.minLength))return`{{name}}'s length cannot be less than ${s.minLength}`;if(s.maxLength!==void 0&&(typeof(t==null?void 0:t.length)!="number"||t.length>s.maxLength))return`{{name}}'s length cannot be greater than ${s.maxLength}`;if(s.min!==void 0&&(typeof t!="number"||t<s.min))return`{{name}} cannot be less than ${s.min}`;if(s.max!==void 0&&(typeof t!="number"||t>s.max))return`{{name}} cannot be greater than ${s.max}`;if(s.pattern&&(typeof t!="string"&&typeof t!="number"||!s.pattern.test(`${t}`)))return`{{name}} not match ${s.pattern.toString()}`;const r=Object.keys(W);for(const a of r)if(s[a]===!0){const l=W[a](t,e);typeof l=="object"&&typeof l.cancel=="function"&&i(()=>{var h;return(h=l.cancel)==null?void 0:h.call(l)});const u=await l;if(u)return u}if(s.validator){const a=s.validator(t,e);typeof a=="object"&&typeof a.cancel=="function"&&i(()=>{var l;return(l=a.cancel)==null?void 0:l.call(a)});const n=await a;if(n)return n}return""});class gt{constructor(t,e){this.rules=x([]),this.deps=null,this.validateCount=0,this.transform=null,this.isEqual=null,this.focusFn=null,this.stopValidateWatcher=null,this.stopDirtyWatcher=null,this.isRegistered=!1,this.isInited=!1,this.runInAction=a=>{a()};const{immediate:i=!0}=e;this.form=t,this.name=e.name,this.rules.value=e.rules||[],this.deps=e.deps||null,this.transform=e.transform||null,this.isEqual=e.isEqual||null,this.focusFn=e.onFocus||null,this.state=R({error:null,isError:!1,isValidating:!1,isDirty:!1,isTouched:!1,isChanged:!1});const r=async(a,n,l)=>{const u=this.transform;return await D(async h=>{for(const y of l){const m=pt(y,u&&a!==void 0?u(a):a,n);h(()=>{var E;return(E=m.cancel)==null?void 0:E.call(m)});const f=await m;let F=null;if(f)return F=typeof f=="string"?{type:y.type,message:f}:f,F.message=F.message.replace(/\{\{name\}\}/g,this.name),y.message!==void 0&&(F.message=y.message.replace(/\{\{name\}\}/g,this.name)),F}return null})};this.validate=r,i&&this.onRegister()}getValue(){return g(this.form.state.values,this.name)}getDefaultValue(){return g(this.form.state.defaultValues,this.name)}update(t={}){t.rules&&(this.rules.value=t.rules)}initWatcher(){this.isInited||(this.stopValidateWatcher=T(async t=>{var e;this.validateCount++;const i=this.validateCount,r=this.getValue(),a=(e=this.deps)==null?void 0:e.call(this),n=this.rules.value,l=await Promise.resolve().then(()=>{const u=this.validate(r,a,n);return t(()=>{var h;return(h=u.cancel)==null?void 0:h.call(u)}),u});i===this.validateCount&&this.runInAction(()=>{this.state.isValidating=!1;const u=!!(l!=null&&l.message);u?(this.state.error||(this.state.error={message:""}),this.state.error.message=(l==null?void 0:l.message)||"",this.state.error.type=l==null?void 0:l.type):this.state.error=null,this.state.isError=u})}),this.stopDirtyWatcher=T(()=>{const t=this.getValue(),e=this.getDefaultValue();this.runInAction(()=>{const i=this.isEqual||((r,a)=>r===a);this.state.isDirty=!i(p(t),p(e))})}),this.isInited=!0)}onRegister(){this.isRegistered||(this.initWatcher(),this.isRegistered=!0)}onUnregister(){var t,e;(t=this.stopValidateWatcher)==null||t.call(this),(e=this.stopDirtyWatcher)==null||e.call(this),this.isRegistered=!1,this.isInited=!1}onTouched(t=!0){this.runInAction(()=>{this.state.isTouched=t})}onChanged(t=!0){this.state.isChanged=t}onFocus(){var t;(t=this.focusFn)==null||t.call(this)}reset(t={}){var e,i;this.validateCount++,(e=this.stopValidateWatcher)==null||e.call(this),(i=this.stopDirtyWatcher)==null||i.call(this),this.runInAction(()=>{const{keepChanged:r=!1,keepTouched:a=!1}=t;this.state.error=null,this.state.isError=!1,this.state.isValidating=!1,this.state.isDirty=!1,this.state.isTouched=a?this.state.isTouched:!1,this.state.isChanged=r?this.state.isChanged:!1}),this.isInited=!1,this.initWatcher()}}const yt=(s,t)=>D(async e=>{if(s.required&&!t&&t!==0||s.requiredLength&&(typeof(t==null?void 0:t.length)!="number"||t.length<=0))return"{{name}} is required";if(s.minLength!==void 0&&(typeof(t==null?void 0:t.length)!="number"||t.length<s.minLength))return`{{name}}'s length cannot be less than ${s.minLength}`;if(s.maxLength!==void 0&&(typeof(t==null?void 0:t.length)!="number"||t.length>s.maxLength))return`{{name}}'s length cannot be greater than ${s.maxLength}`;if(s.min!==void 0&&(typeof t!="number"||t<s.min))return`{{name}} cannot be less than ${s.min}`;if(s.max!==void 0&&(typeof t!="number"||t>s.max))return`{{name}} cannot be greater than ${s.max}`;if(s.pattern&&(typeof t!="string"&&typeof t!="number"||!s.pattern.test(`${t}`)))return`{{name}} not match ${s.pattern.toString()}`;const i=Object.keys(W);for(const r of i)if(s[r]===!0){const n=W[r](t);typeof n=="object"&&typeof n.cancel=="function"&&e(()=>{var u;return(u=n.cancel)==null?void 0:u.call(n)});const l=await n;if(l)return l}if(s.validator){const r=s.validator(t);typeof r=="object"&&typeof r.cancel=="function"&&e(()=>{var n;return(n=r.cancel)==null?void 0:n.call(r)});const a=await r;if(a)return a}return""});class mt{constructor(t,e){this.name="",this.rules=x([]),this.validateCount=0,this.stopValidateWatcher=null,this.isRegistered=!1,this.isInited=!1,this.runInAction=a=>{a()};const{immediate:i=!0}=e;this.form=t,this.name=e.name,this.value=e.value,this.rules.value=e.rules||[],this.state=R({name:this.name,error:null,isError:!1,isValidating:!1});const r=(a,n)=>D(async l=>{let u=null;for(const h of n){const y=yt(h,a);l(()=>{var f;return(f=y.cancel)==null?void 0:f.call(y)});const m=await y;if(m)return u=typeof m=="string"?{type:h.type,message:m}:m,u.message=u.message.replace(/\{\{name\}\}/g,this.name),h.message!==void 0&&(u.message=h.message.replace(/\{\{name\}\}/g,this.name)),u}return null});this.validate=r,i&&this.initWatcher()}update(t){t.rules&&(this.rules.value=t.rules),t.value&&(this.value=t.value)}initWatcher(){this.isInited||(this.stopValidateWatcher=T(async t=>{this.validateCount++;const e=this.validateCount;this.runInAction(()=>{this.state.isValidating=!0});const i=this.value(),r=this.rules.value,a=await Promise.resolve().then(()=>{const n=this.validate(i,r);return t(()=>{var l;return(l=n.cancel)==null?void 0:l.call(n)}),n});e===this.validateCount&&this.runInAction(()=>{this.state.isValidating=!1;const n=!!(a!=null&&a.message);n?(this.state.error||(this.state.error={message:""}),this.state.error.message=(a==null?void 0:a.message)||"",this.state.error.type=a==null?void 0:a.type):this.state.error=null,this.state.isError=n})}),this.isInited=!0)}onRegister(){this.isRegistered||(this.initWatcher(),this.isRegistered=!0)}onUnregister(){var t;(t=this.stopValidateWatcher)==null||t.call(this),this.isRegistered=!1,this.isInited=!1}}class _t{constructor(t){this.touchType="BLUR",this._publicState=null,this.fieldsKeys=x([]),this.fields=new Map,this.virtualFieldsKeys=x([]),this.virtualFields=new Map,this.cacheFields=[],this.cacheVirtualFields=[],this.stopStateWatcher=null,this.stopStatusWatcher=null,this.stopValidatingWatcher=null,this.waiters=[],this.subscribers=[],this.isMounted=!1,this.readonly=!1,this.submitFlag=0,this.runInAction=i=>{i()};const{initValues:e={}}=t;this.initValues=p(e),this.defaultValues=p(t.defaultValues),this._state=R({values:e,defaultValues:t.defaultValues||e,fieldErrors:{},virtualErrors:{},error:null,fieldError:null,virtualError:null,isError:!1,isFieldError:!1,isVirtualError:!1,isValidating:!1,isFieldValidating:!1,isVirtualValidating:!1,isDirty:!1,isTouched:!1,isChanged:!1,isSubmitted:!1,isSubmitting:!1,submitCount:0}),this.touchType=t.touchType||"BLUR",this.readonly=t.readonly||!1}get state(){return this.readonly?(this._publicState||(this._publicState=G(this._state)),this._publicState):this._state}mount(){if(this.isMounted)return;const{cacheFields:t,cacheVirtualFields:e}=this;for(const i of t){const r=this.fields.get(i);r==null||r.initWatcher()}for(const i of e){const r=this.virtualFields.get(i);r==null||r.initWatcher()}this.cacheFields=[],this.cacheVirtualFields=[],this.fieldsKeys.value.push(...t),this.virtualFieldsKeys.value.push(...e),this.stopStateWatcher=T(()=>{const i=this.fieldsKeys.value,r=this.virtualFieldsKeys.value;let a=!1,n=!1,l=!1,u=!1,h=!1,y=!1,m=!1,f=null,F=null;const E={},$={};i.forEach(A=>{const b=this.fields.get(A);if(!b)return;const o=b.state.error,d=b.state.isError,c=b.state.isValidating,v=b.state.isDirty,_=b.state.isTouched,w=b.state.isChanged;I(E,A,o),d&&(a=!0),c&&(l=!0),v&&(h=!0),_&&(y=!0),w&&(m=!0),o&&!f&&(f=o)}),r.forEach(A=>{const b=this.virtualFields.get(A);if(!b)return;const o=b.state.error,d=b.state.isError,c=b.state.isValidating;I($,A,o),d&&(n=!0),c&&(u=!0),o&&!F&&(F=o)}),this.runInAction(()=>{q(this._state.fieldErrors,E),q(this._state.virtualErrors,$),this._state.isFieldError=a,this._state.isVirtualError=n,this._state.isError=a||n,this._state.fieldError=f,this._state.virtualError=F,this._state.error=f||F,this._state.isFieldValidating=l,this._state.isVirtualValidating=u,this._state.isValidating=l||u,this._state.isDirty=h,this._state.isTouched=y,this._state.isChanged=m})}),this.stopValidatingWatcher=T(()=>{this._state.isValidating||this.waiters.forEach(r=>{r()}),this.waiters=[]}),this.isMounted=!0}unmount(){var t,e,i;(t=this.stopStateWatcher)==null||t.call(this),(e=this.stopStatusWatcher)==null||e.call(this),(i=this.stopValidatingWatcher)==null||i.call(this);const r=[...this.fieldsKeys.value];for(const n of r)this.unregisterField(n);const a=[...this.virtualFieldsKeys.value];for(const n of a)this.unregisterVirtualField(n);for(const n of this.cacheFields)this.unregisterField(n);for(const n of this.cacheVirtualFields)this.unregisterVirtualField(n);this.subscribers=[],this.reset({values:p(this.initValues),defaultValues:p(this.defaultValues)}),this.isMounted=!1}registerField(t,e={}){const{immediate:i=!0}=e,{fieldsKeys:r,fields:a,cacheFields:n}=this;if(r.value.includes(t)||n.includes(t))return console.warn(`Duplicate field <${t}>.`),{field:this.fields.get(t),register:()=>{}};for(const h of[...r.value,...n])if(h.startsWith(`${t}.`)||t.startsWith(`${h}.`))return console.warn(`Fields can not be nested together: <${t}> <${h}>. If you want do this, please use [registerVirtualField]`),{field:this.fields.get(t),register:()=>{}};const l=new gt(this,k(O({},e),{name:t}));a.set(t,l);const u=()=>{this.runInAction(()=>{this.isMounted?(this.fieldsKeys.value.push(t),l.initWatcher()):this.cacheFields.push(t)})};return i?(u(),{field:l,register:()=>{}}):{register:u,field:l}}registerVirtualField(t,e){const{immediate:i=!0}=e,{virtualFieldsKeys:r,virtualFields:a,cacheVirtualFields:n}=this;if(r.value.includes(t)||n.includes(t))return console.warn(`Duplicate virtual field <${t}>.`),{field:this.virtualFields.get(t),register:()=>{}};const l=new mt(this,k(O({},e),{name:t}));a.set(t,l);const u=()=>{this.runInAction(()=>{this.isMounted?(this.virtualFieldsKeys.value.push(t),l.initWatcher()):this.cacheVirtualFields.push(t)})};return i?(u(),{field:l,register:()=>{}}):{register:u,field:l}}unregisterField(t,e={}){const{removeValue:i=!1}=e,{fields:r}=this,a=r.get(t);if(!!a){if(a.onUnregister(),this.isMounted){const n=this.fieldsKeys.value.indexOf(t);n!==-1&&this.fieldsKeys.value.splice(n,1)}else{const n=this.cacheFields.indexOf(t);n!==-1&&this.cacheFields.splice(n,1)}this.runInAction(()=>{i&&C(this._state.values,t),i&&C(this._state.defaultValues,t),C(this._state.fieldErrors,t)}),r.delete(t)}}unregisterVirtualField(t){const{virtualFields:e}=this,i=e.get(t);if(!!i){if(i.onUnregister(),this.isMounted){const r=this.virtualFieldsKeys.value.indexOf(t);r!==-1&&this.virtualFieldsKeys.value.splice(r,1)}else{const r=this.cacheVirtualFields.indexOf(t);r!==-1&&this.cacheVirtualFields.splice(r,1)}this.runInAction(()=>{C(this._state.virtualErrors,t)}),e.delete(t)}}setPathValue(t,e){I(this._state.values,t,e),this.notify("UPDATE",t)}setValue(t,e){const i=this.fields.get(t);if(!i){console.warn(`Field not exists <${t}>.`);return}const a=p(g(this._state.values,t))!==p(e);this.setPathValue(t,e),i.onChanged(i.state.isChanged||a)}deletePathValue(t){C(this._state.values,t),this.notify("DELETE",t)}deleteValue(t){if(!this.fields.get(t)){console.warn(`Field not exists <${t}>.`);return}this.deletePathValue(t)}getPathValueRef(t){return L(()=>g(this.state.values,t))}getValueRef(t){return L(()=>{if(!this.fieldsKeys.value.includes(t)){console.warn(`Field not exists <${t}>.`);return}return g(this.state.values,t)})}getPathValue(t){return g(this.state.values,t)}getValue(t){if(!this.fieldsKeys.value.includes(t)){console.warn(`Field not exists <${t}>.`);return}return g(this.state.values,t)}setTouched(t,e=!0){const i=this.fields.get(t);if(!i){console.warn(`Field not exists <${t}>.`);return}i.onTouched(e)}setFocus(t){const e=this.fields.get(t);if(!e){console.warn(`Field not exists <${t}>.`);return}e.onFocus()}submit(t={}){const e=this.submitFlag,i=()=>{var r,a;if(e===this.submitFlag){if(this.runInAction(()=>{this._state.isSubmitting=!1}),this._state.isError){(r=t.onError)==null||r.call(t,p(this._state.error));return}this.runInAction(()=>{this._state.isSubmitted=!0}),(a=t.onSuccess)==null||a.call(t,p(this._state.values))}};this.runInAction(()=>{this._state.submitCount++,this._state.isSubmitting=!0}),this._state.isValidating?this.waiters.push(()=>{i()}):i()}reset(t={}){this.waiters=[],this.runInAction(()=>{t.values?(this._state.values=p(t.values),this.initValues=p(t.values)):t.keepValues||(this._state.values=this.initValues),t.defaultValues?(this._state.defaultValues=p(t.defaultValues),this.defaultValues=t.defaultValues):t.keepDefaultValues||(this._state.defaultValues=this.initValues||this.defaultValues),this.submitFlag++,this._state.isSubmitting=!1,this._state.submitCount=t.keepSubmitCount?this._state.submitCount:0,this._state.isSubmitted=t.keepIsSubmitted?this._state.isSubmitted:!1});for(const[,e]of this.fields)e.reset({keepTouched:t.keepTouched,keepChanged:t.keepChanged});this.notify("RESET")}resetField(t,e={}){const i=this.fields.get(t);if(!i){console.warn(`Field not exists <${t}>.`);return}if("defaultValue"in e&&I(this._state.defaultValues,t,p(e.defaultValue)),"value"in e)I(this._state.values,t,p(e.value));else if(!e.keepValue){const r=g(this._state.defaultValues,t);I(this._state.values,t,p(r))}i.reset({keepTouched:e.keepTouched,keepChanged:e.keepChanged})}subscribe(t){return this.subscribers.push(t),()=>{const i=this.subscribers.indexOf(t);i!==-1&&this.subscribers.splice(i,1)}}notify(t,e){this.subscribers.forEach(i=>{i(t,e)})}fieldState(t){if(!this.fieldsKeys.value.includes(t))return null;const e=this.fields.get(t);return e?e.state:null}virtualFieldState(t){if(!this.virtualFieldsKeys.value.includes(t))return null;const e=this.virtualFields.get(t);return e?e.state:null}isDirty(t){var e;return((e=this.fieldState(t))==null?void 0:e.isDirty)||!1}isTouched(t){var e;return((e=this.fieldState(t))==null?void 0:e.isTouched)||!1}isChanged(t){var e;return((e=this.fieldState(t))==null?void 0:e.isChanged)||!1}isError(t){var e;return((e=this.fieldState(t))==null?void 0:e.isError)||!1}fieldError(t){var e;return((e=this.fieldState(t))==null?void 0:e.error)||null}isVirtualError(t){var e;return((e=this.virtualFieldState(t))==null?void 0:e.isError)||!1}virtualFieldError(t){var e;return((e=this.virtualFieldState(t))==null?void 0:e.error)||null}arrayAppend(t,e){const i=g(this._state.values,t);!Array.isArray(i)||(i.push(e),this.notify("UPDATE",t))}arrayPrepend(t,e){const i=g(this._state.values,t);!Array.isArray(i)||(i.unshift(e),this.notify("UPDATE",t))}arrayInsert(t,e,i){const r=g(this._state.values,t);!Array.isArray(r)||(r.splice(e,0,i),this.notify("UPDATE",t))}arraySwap(t,e,i){const r=g(this._state.values,t);if(!Array.isArray(r))return;const a=r[i];r[i]=r[e],r[e]=a,this.notify("UPDATE",t)}arrayMove(t,e,i){const r=g(this._state.values,t);!Array.isArray(r)||(r.splice(i,0,r[e]),r.splice(i>e?e:e+1),this.notify("UPDATE",t))}arrayUpdate(t,e,i){const r=g(this._state.values,t);!Array.isArray(r)||(r.splice(e,1,i),this.notify("UPDATE",t))}arrayRemove(t,e){const i=g(this._state.values,t);!Array.isArray(i)||(i.splice(e,1),this.notify("UPDATE",t))}arrayReplace(t,e){const i=g(this._state.values,t);!Array.isArray(i)||(I(this._state.values,t,e),this.notify("UPDATE",t))}}const Vt=s=>new _t(s),bt=s=>{const{form:t,name:e}=s,i=L(()=>s.touchType?V(s.touchType):t.touchType||"BLUR"),r=x(!1),a=x(null),n=o=>a.value=o,l=o=>{var d,c;const v=typeof o=="object"&&typeof o.currentTarget=="object"&&((d=o.currentTarget)==null?void 0:d.value)!==void 0?(c=o.currentTarget)==null?void 0:c.value:o;t.setValue(V(e),v)},u=()=>{i.value==="BLUR"&&t.setTouched(V(e),!0)},h=()=>{i.value==="FOCUS"&&t.setTouched(V(e),!0)};let{register:y,field:m}=t.registerField(V(e),{rules:V(s.rules),transform:s.transform,deps:s.deps,immediate:!1,onFocus:()=>{var o,d;(d=(o=a.value)==null?void 0:o.focus)==null||d.call(o)}});const f=x(g(t.state.values,V(s.name))),F=x(m.state),E=S(()=>[V(s.name),V(s.rules)],([o,d],[c])=>{t.unregisterField(c);const v=t.registerField(o,{rules:d,transform:s.transform,deps:s.deps,isEqual:s.isEqual,immediate:r.value,onFocus:()=>{var _,w;(w=(_=a.value)==null?void 0:_.focus)==null||w.call(_)}});y=v.register,m=v.field,F.value=v.field.state,f.value=g(t.state.values,V(s.name))}),$=S(()=>g(t.state.values,V(s.name)),o=>{f.value=o}),A=S(()=>f.value,o=>{const d=g(t.state.values,V(s.name));p(d)!==p(o)&&(f.value=o)});return tt(()=>{y==null||y(),r.value=!0}),z(()=>{t.unregisterField(V(e)),E(),$(),A(),a.value=null}),[R({get value(){return f.value},onChange:l,onBlur:u,onFocus:h,ref:n}),f,{mounted:r}]},Ft=(s,t)=>{let e=0,i=s.getPathValue(t);Array.isArray(i)||(s.setPathValue(t,[]),i=s.getPathValue(t));const a=i.map(()=>({id:`${e++}`}));let n=a.map(o=>o.id);const l=x(a),u={},h=S(()=>s.getPathValue(t).map(d=>p(d)),(o,d)=>{const c=[...d],v=o.map(_=>{const w=p(_),K=c.findIndex(J=>p(J)===w);let U="";return K===-1?U=`${e++}`:(U=n[K],c[K]=u),{id:`${U}`}});l.value=v,n=v.map(_=>_.id)});return{onCleanup:()=>{h()},get fieldsValue(){return l.value},fields:l,prepend:o=>{s.arrayPrepend(t,o)},append:o=>{s.arrayAppend(t,o)},insert:(o,d)=>{const c=l.value.findIndex(v=>v.id===o);c!==-1&&s.arrayInsert(t,c,d)},swap:(o,d)=>{const c=l.value.findIndex(_=>_.id===o),v=l.value.findIndex(_=>_.id===d);c===-1||v===-1||s.arraySwap(t,c,v)},move:(o,d)=>{const c=l.value.findIndex(_=>_.id===o),v=l.value.findIndex(_=>_.id===d);c===-1||v===-1||c===v||s.arrayMove(t,c,v)},replace:o=>{n=[],s.arrayReplace(t,o)},remove:o=>{const d=l.value.findIndex(c=>c.id===o);d!==-1&&s.arrayRemove(t,d)},update:(o,d)=>{const c=l.value.findIndex(v=>v.id===o);c!==-1&&s.arrayUpdate(t,c,d)}}},Et=(s,t)=>{const e=Ft(s,t),{onCleanup:i}=e,r=Z(e,["onCleanup"]);return z(()=>i()),r},At=H({props:{form:{type:Object,required:!0},name:{type:String,required:!0},rules:{type:Array,default:()=>[]},deps:{type:Function,default:void 0},value:{type:j,default:void 0},defaultValue:{type:j,default:void 0},transform:{type:Function,default:void 0},touchType:{type:String,default:"BLUR"}},setup(s){const e=Q(s),{form:i,rules:r,transform:a,name:n,deps:l}=e,u=Z(e,["form","rules","transform","name","deps"]),[h,,{mounted:y}]=bt(O({form:i.value,rules:r.value,transform:a==null?void 0:a.value,deps:l==null?void 0:l.value,name:n},u));return(m,f)=>V(y)?X(m.$slots,"default",{key:0,field:V(h)}):Y("",!0)}}),It=Vt({initValues:{username:"",password:"",passwordConfirm:"",baseInfo:{birthDay:"",age:""},address:[],schools:[]},touchType:"BLUR",readonly:!1});export{At as _,It as f,Et as u};
