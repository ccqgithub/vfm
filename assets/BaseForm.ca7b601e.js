var Se=Object.defineProperty,we=Object.defineProperties;var Ie=Object.getOwnPropertyDescriptors;var oe=Object.getOwnPropertySymbols;var De=Object.prototype.hasOwnProperty,Ce=Object.prototype.propertyIsEnumerable;var ue=(s,e,t)=>e in s?Se(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,de=(s,e)=>{for(var t in e||(e={}))De.call(e,t)&&ue(s,t,e[t]);if(oe)for(var t of oe(e))Ce.call(e,t)&&ue(s,t,e[t]);return s},ce=(s,e)=>we(s,Ie(e));import{I as D,$ as V,a0 as O,a1 as Te,a2 as B,j as Y,f as W,p as ge,h as d,v as ie,m as H,s as k,J as K,R as ae,a3 as G,_ as j,o as E,c as S,a as u,b as A,w as R,t as I,F as N,l as le,a4 as ye,a5 as be,K as ee,a6 as Pe,L as fe,q as Re}from"./app.4967367c.js";var ke=Object.defineProperty,qe=Object.defineProperties,We=Object.getOwnPropertyDescriptors,M=Object.getOwnPropertySymbols,Ve=Object.prototype.hasOwnProperty,Fe=Object.prototype.propertyIsEnumerable,he=(s,e,t)=>e in s?ke(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,te=(s,e)=>{for(var t in e||(e={}))Ve.call(e,t)&&he(s,t,e[t]);if(M)for(var t of M(e))Fe.call(e,t)&&he(s,t,e[t]);return s},ve=(s,e)=>qe(s,We(e)),re=(s,e)=>{var t={};for(var i in s)Ve.call(s,i)&&e.indexOf(i)<0&&(t[i]=s[i]);if(s!=null&&M)for(var i of M(s))e.indexOf(i)<0&&Fe.call(s,i)&&(t[i]=s[i]);return t};const Le=s=>{const e="{{name}} is not alphabetical";return typeof s!="string"?e:/^[a-zA-Z]*$/.test(s)?"":e},Ue=s=>{const e="{{name}} must be alpha-numeric";return typeof s!="string"&&typeof s!="number"?e:/^[a-zA-Z0-9]*$/.test(`${s}`)?"":e},Ke=s=>{const e="{{name}} must be decimal";return typeof s!="string"&&typeof s!="number"?e:/^[-]?\d*(\.\d+)?$/.test(`${s}`)?"":e},Oe=/^(?:[A-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[A-z0-9!#$%&'*+/=?^_`{|}~-]+)*|"(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21\x23-\x5b\x5d-\x7f]|[\x01-\x09\x0b\x0c\x0e-\x7f])*")@(?:(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9]{2,}(?:[a-z0-9-]*[a-z0-9])?|\[(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?|[a-z0-9-]*[a-z0-9]:(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21-\x5a\x53-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])+)\])$/i,Be=s=>{const e="{{name}} is not a valid email address";return typeof s!="string"?e:Oe.test(s)?"":e},Ne=s=>{const e="{{name}} is not an integer";return typeof s!="string"&&typeof s!="number"?e:/(^[0-9]*$)|(^-[0-9]+$)/.test(`${s}`)?"":e},je=s=>{const e="{{name}} is not a valid IP address";if(typeof s!="string")return e;const t=s.split(".");return t.length===4&&t.every(Me)?"":e},Me=s=>{if(s.length>3||s.length===0||s[0]==="0"&&s!=="0"||!s.match(/^\d+$/))return!1;const e=+s;return e>=0&&e<=255},ze=s=>{const e="{{name}} is not a valid MAC Address";if(typeof s!="string")return e;const t=":",i=s.split(t);return(i.length===6||i.length===8)&&i.every(Ze)?"":e},Ze=s=>s.toLowerCase().match(/^[0-9a-f]{2}$/),He=s=>{const e="{{name}} must be numeric";return typeof s!="string"&&typeof s!="number"?e:/^-?\d*(\.\d+)?$/.test(`${s}`)?"":e},z={alpha:Le,alphaNum:Ue,decimal:Ke,email:Be,integer:Ne,ipAddress:je,macAddress:ze,numeric:He},C=(s,e,t)=>{const i=e.split(".");let a=s;for(;i.length&&typeof a=="object"&&a!==null;){const l=i.shift();i.length===0?a[l]=t:(typeof a[l]!="object"||a[l]===null)&&(a[l]=/^\d+$/.test(l)?[]:{}),a=a[l]}},y=(s,e)=>{const t=e.split(".");let i=s;for(;t.length&&i;){const a=t.shift();i=typeof i=="object"&&i!==null?i[a]:void 0}return i},U=(s,e)=>{const t=e.split(".");let i=s;for(;t.length&&typeof i=="object"&&i!==null;){const a=t.shift();t.length===0?Array.isArray(i)?/^\d+$/.test(a)&&i.splice(Number(a),1):delete i[a]:i=i[a]}},se=(s,e,t=!0)=>{const i=Object.keys(s),a=Object.keys(e),l=i.filter(r=>!a.includes(r));t&&l.forEach(r=>{delete s[r]}),a.forEach(r=>{typeof s[r]=="object"&&!Array.isArray(s[r])&&s[r]!==null&&typeof e[r]=="object"&&!Array.isArray(e[r])&&e[r]!==null?se(s[r],e[r],t):s[r]=e[r]})},me=[String,Number,Boolean,Symbol,Array,Object],J=s=>{let e=[];const i=s(l=>{e.push(l)});return{promise:new Promise((l,r)=>{i.then(n=>{e=[],l(n)},n=>{e=[],r(n)})}),dispose:()=>{e.forEach(l=>l()),e=[]}}},Z=(s,e)=>{let t=null,i=null,a=[];return async(...r)=>(t==null||t(),a.push(new Promise((n,o)=>{let c=null;const h=setTimeout(()=>{const v=s(...r);"promise"in v?(v.promise.then(n,o),c=()=>{var m;(m=v.dispose)==null||m.call(v)}):v.then(n,o)},e);t=()=>{c==null||c(),c=null,clearTimeout(h),o()}})),i||(i=(async()=>{for(;a.length;){const n=a.shift();try{const o=await n;if(!a.length)return o}catch(o){if(!a.length)throw o}}})(),i.finally(()=>{t=null,i=null,a=[]})))},pe=(s,e,t)=>J(async i=>{if(s.required&&!e&&e!==0||s.requiredLength&&(typeof(e==null?void 0:e.length)!="number"||e.length<=0))return"{{name}} is required";if(s.minLength!==void 0&&(typeof(e==null?void 0:e.length)!="number"||e.length<s.minLength))return`{{name}}'s length cannot be less than ${s.minLength}`;if(s.maxLength!==void 0&&(typeof(e==null?void 0:e.length)!="number"||e.length>s.maxLength))return`{{name}}'s length cannot be greater than ${s.maxLength}`;if(s.min!==void 0&&(typeof e!="number"||e<s.min))return`{{name}} cannot be less than ${s.min}`;if(s.max!==void 0&&(typeof e!="number"||e>s.max))return`{{name}} cannot be greater than ${s.max}`;if(s.pattern&&(typeof e!="string"&&typeof e!="number"||!s.pattern.test(`${e}`)))return`{{name}} not match ${s.pattern.toString()}`;const a=Object.keys(z);for(const l of a)if(s[l]===!0){const n=z[l](e,t);typeof n=="object"&&"dispose"in n&&typeof n.dispose=="function"&&i(()=>{var c;return(c=n.dispose)==null?void 0:c.call(n)});const o=typeof n=="object"&&"promise"in n?await n.promise:await n;if(o)return o}if(s.validator){const l=s.validator(e,t);typeof l=="object"&&"dispose"in l&&typeof l.dispose=="function"&&i(()=>{var n;return(n=l.dispose)==null?void 0:n.call(l)});const r=typeof l=="object"&&"promise"in l?await l.promise:await l;if(r)return r}return""});class Ge{constructor(e,t){this.rules=D([]),this.deps=null,this.validateDispose=null,this.debounce=0,this.transform=null,this.isEqual=null,this.focusFn=null,this.stopValidateWatcher=null,this.stopDirtyWatcher=null,this.isRegistered=!1,this.isInited=!1,this.runInAction=l=>{l()};const{immediate:i=!0}=t;this.form=e,this.name=t.name,this.setRules(t.rules||[]),this.deps=t.deps||null,this.transform=t.transform||null,this.isEqual=t.isEqual||null,this.focusFn=t.onFocus||null,this.debounce=t.debounce||0,this.initValue=t.initValue,this.initDefaultValue=t.initDefaultValue,this.state=O({error:null,isError:!1,isValidating:!1,isDirty:!1,isTouched:!1,isChanged:!1});const a=(l,r,n)=>{const o=this.transform;let c=!1;return J(async h=>{h(()=>{c=!0});for(const v of n){const m=pe(v,o&&l!==void 0?o(l):l,r);h(()=>{var T;return(T=m.dispose)==null?void 0:T.call(m)});const F=await m.promise;if(c)return null;let w=null;if(F)return w=typeof F=="string"?{type:v.type,message:F}:F,w.message=w.message.replace(/\{\{name\}\}/g,this.name),v.message!==void 0&&(w.message=v.message.replace(/\{\{name\}\}/g,this.name)),w}return null})};this.validate=a,i&&this.onRegister()}getValue(){return y(this.form.state.values,this.name)}getDefaultValue(){return y(this.form.state.defaultValues,this.name)}setRules(e=[]){this.rules.value=e.map(t=>t.debounce?{validator:Z((a,l)=>pe(t,a,l),t.debounce)}:t)}update(e={}){e.rules&&this.setRules(e.rules)}initWatcher(){if(this.isInited)return;const e=async i=>{var a;(a=this.validateDispose)==null||a.call(this),this.validateDispose=null;const{value:l,deps:r,rules:n}=i;let o=!1;const c=this.validate(l,r,n);this.validateDispose=()=>{var v;(v=c.dispose)==null||v.call(c),o=!0,this.validateDispose=null};const h=await c.promise;o||(this.runInAction(()=>{this.state.isValidating=!1;const v=!!(h!=null&&h.message);v?(this.state.error||(this.state.error={message:""}),this.state.error.message=(h==null?void 0:h.message)||"",this.state.error.type=h==null?void 0:h.type):this.state.error=null,this.state.isError=v}),this.validateDispose=null)},t=this.debounce?Z(e,this.debounce):e;this.stopValidateWatcher=B(()=>{var i;this.runInAction(()=>{this.state.isValidating=!0});const a=this.getValue(),l=(i=this.deps)==null?void 0:i.call(this),r=this.rules.value;Promise.resolve().then(()=>{t({value:a,deps:l,rules:r})})}),this.stopDirtyWatcher=B(()=>{const i=this.getValue(),a=this.getDefaultValue();this.runInAction(()=>{const l=this.isEqual||((r,n)=>r===n);this.state.isDirty=!l(V(i),V(a))})}),this.isInited=!0}onRegister(){this.isRegistered||(this.initWatcher(),this.isRegistered=!0)}onUnregister(){var e,t,i;(e=this.validateDispose)==null||e.call(this),this.validateDispose=null,(t=this.stopValidateWatcher)==null||t.call(this),(i=this.stopDirtyWatcher)==null||i.call(this),this.isRegistered=!1,this.isInited=!1}onTouched(e=!0){this.runInAction(()=>{this.state.isTouched=e})}onChanged(e=!0){this.state.isChanged=e}onFocus(){var e;(e=this.focusFn)==null||e.call(this)}reset(e={}){var t,i,a;(t=this.validateDispose)==null||t.call(this),this.validateDispose=null,(i=this.stopValidateWatcher)==null||i.call(this),(a=this.stopDirtyWatcher)==null||a.call(this),this.runInAction(()=>{const{keepChanged:l=!1,keepTouched:r=!1}=e;this.state.error=null,this.state.isError=!1,this.state.isValidating=!1,this.state.isDirty=!1,this.state.isTouched=r?this.state.isTouched:!1,this.state.isChanged=l?this.state.isChanged:!1}),this.isInited=!1,this.initWatcher()}}const _e=(s,e)=>J(async t=>{if(s.required&&!e&&e!==0||s.requiredLength&&(typeof(e==null?void 0:e.length)!="number"||e.length<=0))return"{{name}} is required";if(s.minLength!==void 0&&(typeof(e==null?void 0:e.length)!="number"||e.length<s.minLength))return`{{name}}'s length cannot be less than ${s.minLength}`;if(s.maxLength!==void 0&&(typeof(e==null?void 0:e.length)!="number"||e.length>s.maxLength))return`{{name}}'s length cannot be greater than ${s.maxLength}`;if(s.min!==void 0&&(typeof e!="number"||e<s.min))return`{{name}} cannot be less than ${s.min}`;if(s.max!==void 0&&(typeof e!="number"||e>s.max))return`{{name}} cannot be greater than ${s.max}`;if(s.pattern&&(typeof e!="string"&&typeof e!="number"||!s.pattern.test(`${e}`)))return`{{name}} not match ${s.pattern.toString()}`;const i=Object.keys(z);for(const a of i)if(s[a]===!0){const r=z[a](e);typeof r=="object"&&"dispose"in r&&typeof r.dispose=="function"&&t(()=>{var o;return(o=r.dispose)==null?void 0:o.call(r)});const n=typeof r=="object"&&"promise"in r?await r.promise:await r;if(n)return n}if(s.validator){const a=s.validator(e);typeof a=="object"&&"dispose"in a&&typeof a.dispose=="function"&&t(()=>{var r;return(r=a.dispose)==null?void 0:r.call(a)});const l=typeof a=="object"&&"promise"in a?await a.promise:await a;if(l)return l}return""});class Je{constructor(e,t){this.name="",this.rules=D([]),this.validateDispose=null,this.debounce=0,this.stopValidateWatcher=null,this.isRegistered=!1,this.isInited=!1,this.runInAction=l=>{l()};const{immediate:i=!0}=t;this.form=e,this.name=t.name,this.value=t.value,this.setRules(t.rules||[]),this.debounce=t.debounce||0,this.state=O({name:this.name,error:null,isError:!1,isValidating:!1});const a=(l,r)=>{let n=!1;return J(async o=>{o(()=>{n=!0});for(const c of r){const h=_e(c,l);o(()=>{var F;return(F=h.dispose)==null?void 0:F.call(h)});const v=await h.promise;if(n)return null;let m=null;if(v)return m=typeof v=="string"?{type:c.type,message:v}:v,m.message=m.message.replace(/\{\{name\}\}/g,this.name),c.message!==void 0&&(m.message=c.message.replace(/\{\{name\}\}/g,this.name)),m}return null})};this.validate=a,i&&this.initWatcher()}setRules(e=[]){this.rules.value=e.map(t=>t.debounce?{validator:Z(a=>_e(t,a),t.debounce)}:t)}update(e){e.rules&&this.setRules(e.rules),e.value&&(this.value=e.value)}initWatcher(){var e;if(this.isInited)return;(e=this.validateDispose)==null||e.call(this),this.validateDispose=null;const t=async a=>{this.runInAction(()=>{this.state.isValidating=!0});const{value:l,rules:r}=a;let n=!1;const o=this.validate(l,r);this.validateDispose=()=>{var h;(h=o.dispose)==null||h.call(o),n=!0,this.validateDispose=null};const c=await o.promise;n||(this.runInAction(()=>{this.state.isValidating=!1;const h=!!(c!=null&&c.message);h?(this.state.error||(this.state.error={message:""}),this.state.error.message=(c==null?void 0:c.message)||"",this.state.error.type=c==null?void 0:c.type):this.state.error=null,this.state.isError=h}),this.validateDispose=null)},i=this.debounce?Z(t,this.debounce):t;this.stopValidateWatcher=B(()=>{const a=this.value(),l=this.rules.value;Promise.resolve().then(()=>{i({value:a,rules:l})})}),this.isInited=!0}onRegister(){this.isRegistered||(this.initWatcher(),this.isRegistered=!0)}onUnregister(){var e,t;(e=this.validateDispose)==null||e.call(this),this.validateDispose=null,(t=this.stopValidateWatcher)==null||t.call(this),this.isRegistered=!1,this.isInited=!1}}class Qe{constructor(e){this.touchType="BLUR",this._publicState=null,this.fieldsKeys=D([]),this.fields=new Map,this.virtualFieldsKeys=D([]),this.virtualFields=new Map,this.cacheFields=[],this.cacheVirtualFields=[],this.stopStateWatcher=null,this.stopStatusWatcher=null,this.stopValidatingWatcher=null,this.waiters=[],this.subscribers=[],this.isMounted=!1,this.readonly=!1,this.submitFlag=0,this.runInAction=i=>{i()};const{initValues:t={}}=e;this.initValues=V(t),this.defaultValues=V(e.defaultValues||e.initValues),this._state=O({values:t,defaultValues:e.defaultValues||t,fieldErrors:{},virtualErrors:{},error:null,fieldError:null,virtualError:null,isError:!1,isFieldError:!1,isVirtualError:!1,isValidating:!1,isFieldValidating:!1,isVirtualValidating:!1,isDirty:!1,isTouched:!1,isChanged:!1,isSubmitted:!1,isSubmitting:!1,submitCount:0}),this.touchType=e.touchType||"BLUR",this.readonly=e.readonly||!1}get state(){return this.readonly?(this._publicState||(this._publicState=Te(this._state)),this._publicState):this._state}mount(){if(this.isMounted)return;const{cacheFields:e,cacheVirtualFields:t}=this;for(const i of e){const a=this.fields.get(i);a.initWatcher(),a.initDefaultValue!==void 0&&C(this._state.defaultValues,i,a.initDefaultValue),a.initValue!==void 0&&C(this._state.values,i,a.initValue)}for(const i of t){const a=this.virtualFields.get(i);a==null||a.initWatcher()}this.cacheFields=[],this.cacheVirtualFields=[],this.fieldsKeys.value.push(...e),this.virtualFieldsKeys.value.push(...t),this.stopStateWatcher=B(()=>{const i=this.fieldsKeys.value,a=this.virtualFieldsKeys.value;let l=!1,r=!1,n=!1,o=!1,c=!1,h=!1,v=!1,m=null,F=null;const w={},T={};i.forEach(P=>{const x=this.fields.get(P);if(!x)return;const f=x.state.error,_=x.state.isError,g=x.state.isValidating,b=x.state.isDirty,$=x.state.isTouched,L=x.state.isChanged;C(w,P,f),_&&(l=!0),g&&(n=!0),b&&(c=!0),$&&(h=!0),L&&(v=!0),f&&!m&&(m=f)}),a.forEach(P=>{const x=this.virtualFields.get(P);if(!x)return;const f=x.state.error,_=x.state.isError,g=x.state.isValidating;C(T,P,f),_&&(r=!0),g&&(o=!0),f&&!F&&(F=f)}),this.runInAction(()=>{se(this._state.fieldErrors,w),se(this._state.virtualErrors,T),this._state.isFieldError=l,this._state.isVirtualError=r,this._state.isError=l||r,this._state.fieldError=m,this._state.virtualError=F,this._state.error=m||F,this._state.isFieldValidating=n,this._state.isVirtualValidating=o,this._state.isValidating=n||o,this._state.isDirty=c,this._state.isTouched=h,this._state.isChanged=v})}),this.stopValidatingWatcher=B(()=>{this._state.isValidating||this.waiters.forEach(a=>{a()}),this.waiters=[]}),this.isMounted=!0}unmount(){var e,t,i;(e=this.stopStateWatcher)==null||e.call(this),(t=this.stopStatusWatcher)==null||t.call(this),(i=this.stopValidatingWatcher)==null||i.call(this);const a=[...this.fieldsKeys.value];for(const r of a)this.unregisterField(r);const l=[...this.virtualFieldsKeys.value];for(const r of l)this.unregisterVirtualField(r);for(const r of this.cacheFields)this.unregisterField(r);for(const r of this.cacheVirtualFields)this.unregisterVirtualField(r);this.subscribers=[],this.reset({values:V(this.initValues),defaultValues:V(this.defaultValues)}),this.isMounted=!1}registerField(e,t={}){const{immediate:i=!0,value:a=y(this.initValues,e),defaultValue:l=y(this.defaultValues||{},e)}=t,{fieldsKeys:r,fields:n,cacheFields:o}=this;if(r.value.includes(e)||o.includes(e))return console.warn(`Duplicate field <${e}>.`),{field:this.fields.get(e),register:()=>{}};for(const v of[...r.value,...o])if(v.startsWith(`${e}.`)||e.startsWith(`${v}.`))return console.warn(`Fields can not be nested together: <${e}> <${v}>. If you want do this, please use [registerVirtualField]`),{field:this.fields.get(e),register:()=>{}};const c=new Ge(this,ve(te({},t),{name:e,initValue:a,initDefaultValue:l}));n.set(e,c);const h=()=>{this.runInAction(()=>{this.isMounted?(l!==void 0&&C(this._state.defaultValues,e,l),a!==void 0&&C(this._state.values,e,l),this.fieldsKeys.value.push(e),c.initWatcher()):this.cacheFields.push(e)})};return i?(h(),{field:c,register:()=>{}}):{register:h,field:c}}registerVirtualField(e,t){const{immediate:i=!0}=t,{virtualFieldsKeys:a,virtualFields:l,cacheVirtualFields:r}=this;if(a.value.includes(e)||r.includes(e))return console.warn(`Duplicate virtual field <${e}>.`),{field:this.virtualFields.get(e),register:()=>{}};const n=new Je(this,ve(te({},t),{name:e}));l.set(e,n);const o=()=>{this.runInAction(()=>{this.isMounted?(this.virtualFieldsKeys.value.push(e),n.initWatcher()):this.cacheVirtualFields.push(e)})};return i?(o(),{field:n,register:()=>{}}):{register:o,field:n}}unregisterField(e,t={}){const{removeValue:i=!1}=t,{fields:a}=this,l=a.get(e);if(!!l){if(l.onUnregister(),this.isMounted){const r=this.fieldsKeys.value.indexOf(e);r!==-1&&this.fieldsKeys.value.splice(r,1)}else{const r=this.cacheFields.indexOf(e);r!==-1&&this.cacheFields.splice(r,1)}this.runInAction(()=>{i&&U(this._state.values,e),i&&U(this._state.defaultValues,e),U(this._state.fieldErrors,e)}),a.delete(e)}}unregisterVirtualField(e){const{virtualFields:t}=this,i=t.get(e);if(!!i){if(i.onUnregister(),this.isMounted){const a=this.virtualFieldsKeys.value.indexOf(e);a!==-1&&this.virtualFieldsKeys.value.splice(a,1)}else{const a=this.cacheVirtualFields.indexOf(e);a!==-1&&this.cacheVirtualFields.splice(a,1)}this.runInAction(()=>{U(this._state.virtualErrors,e)}),t.delete(e)}}setPathValue(e,t){C(this._state.values,e,t),this.notify("UPDATE",e)}setValue(e,t){const i=this.fields.get(e);if(!i){console.warn(`Field not exists <${e}>.`);return}const l=V(y(this._state.values,e))!==V(t);this.setPathValue(e,t),i.onChanged(i.state.isChanged||l)}deletePathValue(e){U(this._state.values,e),this.notify("DELETE",e)}deleteValue(e){if(!this.fields.get(e)){console.warn(`Field not exists <${e}>.`);return}this.deletePathValue(e)}getPathValueRef(e){return Y(()=>y(this.state.values,e))}getValueRef(e){return Y(()=>{if(!this.fieldsKeys.value.includes(e)){console.warn(`Field not exists <${e}>.`);return}return y(this.state.values,e)})}getPathValue(e){return y(this.state.values,e)}getValue(e){if(!this.fieldsKeys.value.includes(e)){console.warn(`Field not exists <${e}>.`);return}return y(this.state.values,e)}setTouched(e,t=!0){const i=this.fields.get(e);if(!i){console.warn(`Field not exists <${e}>.`);return}i.onTouched(t)}setFocus(e){const t=this.fields.get(e);if(!t){console.warn(`Field not exists <${e}>.`);return}t.onFocus()}submit(e={}){const t=this.submitFlag,i=()=>{var a,l;if(t===this.submitFlag){if(this.runInAction(()=>{this._state.isSubmitting=!1}),this._state.isError){(a=e.onError)==null||a.call(e,V(this._state.error));return}this.runInAction(()=>{this._state.isSubmitted=!0}),(l=e.onSuccess)==null||l.call(e,V(this._state.values))}};this.runInAction(()=>{this._state.submitCount++,this._state.isSubmitting=!0}),this._state.isValidating?this.waiters.push(()=>{i()}):i()}reset(e={}){this.waiters=[],this.runInAction(()=>{e.values?(this._state.values=V(e.values),this.initValues=V(e.values)):e.keepValues||(this._state.values=this.initValues),e.defaultValues?(this._state.defaultValues=V(e.defaultValues),this.defaultValues=e.defaultValues):e.keepDefaultValues||(this._state.defaultValues=this.initValues||this.defaultValues),this.submitFlag++,this._state.isSubmitting=!1,this._state.submitCount=e.keepSubmitCount?this._state.submitCount:0,this._state.isSubmitted=e.keepIsSubmitted?this._state.isSubmitted:!1});for(const[,t]of this.fields)t.reset({keepTouched:e.keepTouched,keepChanged:e.keepChanged});this.notify("RESET")}resetField(e,t={}){const i=this.fields.get(e);if(!i){console.warn(`Field not exists <${e}>.`);return}if("defaultValue"in t&&C(this._state.defaultValues,e,V(t.defaultValue)),"value"in t)C(this._state.values,e,V(t.value));else if(!t.keepValue){const a=y(this._state.defaultValues,e);C(this._state.values,e,V(a))}i.reset({keepTouched:t.keepTouched,keepChanged:t.keepChanged})}subscribe(e){return this.subscribers.push(e),()=>{const i=this.subscribers.indexOf(e);i!==-1&&this.subscribers.splice(i,1)}}notify(e,t){this.subscribers.forEach(i=>{i(e,t)})}fieldState(e){if(!this.fieldsKeys.value.includes(e))return null;const t=this.fields.get(e);return t?t.state:null}virtualFieldState(e){if(!this.virtualFieldsKeys.value.includes(e))return null;const t=this.virtualFields.get(e);return t?t.state:null}isDirty(e){var t;return((t=this.fieldState(e))==null?void 0:t.isDirty)||!1}isTouched(e){var t;return((t=this.fieldState(e))==null?void 0:t.isTouched)||!1}isChanged(e){var t;return((t=this.fieldState(e))==null?void 0:t.isChanged)||!1}isValidating(e){var t;return((t=this.fieldState(e))==null?void 0:t.isValidating)||!1}isVirtualValidating(e){var t;return((t=this.virtualFieldState(e))==null?void 0:t.isValidating)||!1}isError(e){var t;return((t=this.fieldState(e))==null?void 0:t.isError)||!1}isVirtualError(e){var t;return((t=this.virtualFieldState(e))==null?void 0:t.isError)||!1}fieldError(e){var t;return((t=this.fieldState(e))==null?void 0:t.error)||null}virtualFieldError(e){var t;return((t=this.virtualFieldState(e))==null?void 0:t.error)||null}arrayAppend(e,t){const i=y(this._state.values,e);!Array.isArray(i)||(i.push(t),this.notify("UPDATE",e))}arrayPrepend(e,t){const i=y(this._state.values,e);!Array.isArray(i)||(i.unshift(t),this.notify("UPDATE",e))}arrayInsert(e,t,i){const a=y(this._state.values,e);!Array.isArray(a)||(a.splice(t,0,i),this.notify("UPDATE",e))}arraySwap(e,t,i){const a=y(this._state.values,e);if(!Array.isArray(a))return;const l=a[i];a[i]=a[t],a[t]=l,this.notify("UPDATE",e)}arrayMove(e,t,i){const a=y(this._state.values,e);!Array.isArray(a)||(a.splice(i,0,a[t]),a.splice(i>t?t:t+1),this.notify("UPDATE",e))}arrayUpdate(e,t,i){const a=y(this._state.values,e);!Array.isArray(a)||(a.splice(t,1,i),this.notify("UPDATE",e))}arrayRemove(e,t){const i=y(this._state.values,e);!Array.isArray(i)||(i.splice(t,1),this.notify("UPDATE",e))}arrayReplace(e,t){const i=y(this._state.values,e);!Array.isArray(i)||(C(this._state.values,e,t),this.notify("UPDATE",e))}}const Xe=s=>new Qe(s),Ye=s=>{const{form:e,name:t}=s,i=Y(()=>s.touchType?d(s.touchType):e.touchType||"BLUR"),a=D(!1),l=D(null),r=f=>l.value=f,n=f=>{var _,g;const b=typeof f=="object"&&typeof f.currentTarget=="object"&&((_=f.currentTarget)==null?void 0:_.value)!==void 0?(g=f.currentTarget)==null?void 0:g.value:f;e.setValue(d(t),b)},o=()=>{i.value==="BLUR"&&e.setTouched(d(t),!0)},c=()=>{i.value==="FOCUS"&&e.setTouched(d(t),!0)};let{register:h,field:v}=e.registerField(d(t),{rules:d(s.rules),transform:s.transform,deps:s.deps,immediate:!1,onFocus:()=>{var f,_;(_=(f=l.value)==null?void 0:f.focus)==null||_.call(f)},debounce:s.debounce,value:s.value,defaultValue:s.defaultValue});const m=D(y(e.state.values,d(s.name))),F=D(v.state),w=K(()=>[d(s.name),d(s.rules)],([f,_],[g])=>{e.unregisterField(g);const b=e.registerField(f,{rules:_,transform:s.transform,deps:s.deps,isEqual:s.isEqual,immediate:a.value,onFocus:()=>{var $,L;(L=($=l.value)==null?void 0:$.focus)==null||L.call($)},debounce:s.debounce,value:s.value,defaultValue:s.defaultValue});h=b.register,v=b.field,F.value=b.field.state,m.value=y(e.state.values,d(s.name))}),T=K(()=>y(e.state.values,d(s.name)),f=>{m.value=f}),P=K(()=>m.value,f=>{const _=y(e.state.values,d(s.name));V(_)!==V(f)&&(m.value=f)});return ae(()=>{h==null||h(),a.value=!0}),G(()=>{e.unregisterField(d(t)),w(),T(),P(),l.value=null}),[s.changeType==="ONCHANGE"?O({get value(){return m.value},onChange:n,onBlur:o,onFocus:c,ref:r}):O({get value(){return m.value},onInput:n,onBlur:o,onFocus:c,ref:r}),m,{mounted:a}]},et=s=>{const{form:e,name:t}=s,i=D(!1);let{register:a,field:l}=e.registerVirtualField(d(t),{value:s.value,rules:d(s.rules),immediate:!1,debounce:s.debounce});const r=D(l.state),n=K(()=>d(s.name),(o,c)=>{e.unregisterVirtualField(c);const h=e.registerVirtualField(d(t),{value:s.value,rules:d(s.rules),immediate:i.value,debounce:s.debounce});a=h.register,l=h.field,r.value=h.field.state});return ae(()=>{a(),i.value=!0}),G(()=>{e.unregisterVirtualField(d(t)),n()}),{mounted:i}},tt=(s,e)=>{let t=0,i=s.getPathValue(e);Array.isArray(i)||(s.setPathValue(e,[]),i=s.getPathValue(e));const l=i.map(f=>({id:`${t++}`,name:`${e}.${f}`}));let r=l.map(f=>f.id);const n=D(l),o={},c=K(()=>s.getPathValue(e).map(_=>V(_)),(f,_)=>{const g=[..._],b=f.map(($,L)=>{const Ee=V($),Q=g.findIndex(Ae=>V(Ae)===Ee);let X="";return Q===-1?X=`${t++}`:(X=r[Q],g[Q]=o),{id:`${X}`,name:`${e}.${L}`}});n.value=b,r=b.map($=>$.id)});return{onCleanup:()=>{c()},get fieldsValue(){return n.value},fields:n,prepend:f=>{s.arrayPrepend(e,f)},append:f=>{s.arrayAppend(e,f)},insert:(f,_)=>{const g=n.value.findIndex(b=>b.id===f);g!==-1&&s.arrayInsert(e,g,_)},swap:(f,_)=>{const g=n.value.findIndex($=>$.id===f),b=n.value.findIndex($=>$.id===_);g===-1||b===-1||s.arraySwap(e,g,b)},move:(f,_)=>{const g=n.value.findIndex($=>$.id===f),b=n.value.findIndex($=>$.id===_);g===-1||b===-1||g===b||s.arrayMove(e,g,b)},replace:f=>{r=[],s.arrayReplace(e,f)},remove:f=>{const _=n.value.findIndex(g=>g.id===f);_!==-1&&s.arrayRemove(e,_)},update:(f,_)=>{const g=n.value.findIndex(b=>b.id===f);g!==-1&&s.arrayUpdate(e,g,_)}}},$e=(s,e)=>{const t=tt(s,e),{onCleanup:i}=t,a=re(t,["onCleanup"]);return G(()=>i()),a},q=W({props:{form:{type:Object,required:!0},name:{type:String,required:!0},rules:{type:Array,default:()=>[]},deps:{type:Function,default:void 0},debounce:{type:Number,default:void 0},value:{type:me,default:void 0},defaultValue:{type:me,default:void 0},transform:{type:Function,default:void 0},touchType:{type:String,default:"BLUR"},changeType:{type:String,default:"ONCHANGE"},isEqual:{type:Function,default:void 0}},setup(s){const t=ge(s),{form:i,rules:a,transform:l,name:r,deps:n,debounce:o,changeType:c,value:h,defaultValue:v,isEqual:m}=t,F=re(t,["form","rules","transform","name","deps","debounce","changeType","value","defaultValue","isEqual"]),[w,,{mounted:T}]=Ye(te({form:i.value,rules:a.value,transform:l==null?void 0:l.value,deps:n==null?void 0:n.value,debounce:o==null?void 0:o.value,name:r,changeType:c.value,value:h==null?void 0:h.value,defaultValue:v==null?void 0:v.value,isEqual:m==null?void 0:m.value},F));return(P,x)=>d(T)?ie(P.$slots,"default",{key:0,field:d(w)}):H("",!0)}}),st=W({props:{form:{type:Object,required:!0},name:{type:String,required:!0},value:{type:Function,required:!0},rules:{type:Array,default:()=>[]},debounce:{type:Number,default:void 0}},setup(s){const e=s,{name:t,form:i,value:a,rules:l,debounce:r}=ge(e),{mounted:n}=et({form:i.value,rules:l.value,value:a.value,debounce:r==null?void 0:r.value,name:t});return(o,c)=>d(n)?ie(o.$slots,"default",{key:0}):H("",!0)}}),it=W({props:{form:{type:Object,required:!0},name:{type:String,required:!0}},setup(s){const e=s,t=$e(e.form,e.name),{fieldsValue:i,fields:a}=t,l=re(t,["fieldsValue","fields"]);return(r,n)=>ie(r.$slots,"default",k(l,{fields:d(a)}))}}),p=Xe({initValues:{username:"",password:"",passwordConfirm:"",baseInfo:{birthDay:"",age:""},tags:[],address:[],schools:[]},touchType:"BLUR",readonly:!1}),at=u("div",{class:"vfm-block-title"},"Base Info",-1),lt={class:"vfm-p"},rt=u("div",{class:"vfm-label"}," Birth Day: ",-1),nt={class:"vfm-value"},ot={class:"vfm-error"},ut={class:"vfm-p"},dt=u("div",{class:"vfm-label"}," Age: ",-1),ct={class:"vfm-value"},ft={class:"vfm-error"},ht=W({setup(s){return p.state,(e,t)=>{var i,a;return E(),S(N,null,[at,u("div",lt,[rt,u("div",nt,[A(d(q),{form:d(p),name:"baseInfo.birthDay",rules:[{required:!0}],value:"1988"},{default:R(({field:l})=>[u("input",k({class:"vfm-input",type:"text"},l),null,16)]),_:1},8,["form"]),u("div",ot,I((i=d(p).fieldError("baseInfo.birthDay"))==null?void 0:i.message),1)])]),u("div",ut,[dt,u("div",ct,[A(d(q),{form:d(p),name:"baseInfo.age",rules:[{required:!0}]},{default:R(({field:l})=>[u("input",k({class:"vfm-input",type:"text"},l),null,16)]),_:1},8,["form"]),u("div",ft,I((a=d(p).fieldError("baseInfo.age"))==null?void 0:a.message),1)])])],64)}}});var vt=j(ht,[["__file","BaseInfo.vue"]]);const ne=s=>(ye("data-v-c93a4b10"),s=s(),be(),s),mt=ne(()=>u("div",{class:"vfm-block-title"},"Address",-1)),pt={class:"vfm-p"},_t=ne(()=>u("div",{class:"vfm-label"}," Phone: ",-1)),gt={class:"vfm-value"},yt={class:"vfm-error"},bt={class:"vfm-p"},Vt=ne(()=>u("div",{class:"vfm-label"}," Detail: ",-1)),Ft={class:"vfm-value"},$t={class:"vfm-error"},xt={class:"vfm-p"},Et=["onClick"],At={class:"vfm-p"},St=W({setup(s){const{fields:e,append:t,remove:i}=$e(p,"address"),a=()=>{t({phone:"",detail:""})},l=r=>{i(r)};return(r,n)=>(E(),S(N,null,[mt,(E(!0),S(N,null,le(d(e),(o,c)=>{var h,v;return E(),S("div",{class:"block",key:o.id},[u("div",pt,[_t,u("div",gt,[A(d(q),{form:d(p),name:`address.${c}.phone`,rules:[{required:!0}]},{default:R(({field:m})=>[u("input",k({class:"vfm-input",type:"text"},m),null,16)]),_:2},1032,["form","name"]),u("div",yt,I((h=d(p).fieldError(`address.${c}.phone`))==null?void 0:h.message),1)])]),u("div",bt,[Vt,u("div",Ft,[A(d(q),{form:d(p),name:`address.${c}.detail`,rules:[{required:!0}]},{default:R(({field:m})=>[u("input",k({class:"vfm-input",type:"text"},m),null,16)]),_:2},1032,["form","name"]),u("div",$t,I((v=d(p).fieldError(`address.${c}.detail`))==null?void 0:v.message),1)])]),u("div",xt,[u("div",{class:"vfm-action red",onClick:()=>l(o.id)},"- delete",8,Et)])])}),128)),u("div",At,[u("div",{class:"vfm-action",onClick:n[0]||(n[0]=()=>a())},"+ Add Address")])],64))}});var wt=j(St,[["__scopeId","data-v-c93a4b10"],["__file","AddressList.vue"]]);const It={class:"sbox"},Dt=["onUpdate:modelValue"],Ct=W({props:{visible:{type:Boolean,default:!1},value:{type:Array,default:()=>[]}},emits:["change","update:visible"],setup(s,{emit:e}){const t=s,a=D([{name:"School A",address:"School Address A"},{name:"School B",address:"School Address B"},{name:"School C",address:"School Address C"},{name:"School D",address:"School Address D"},{name:"School E",address:"School Address E"}].map(n=>{const o=t.value.find(c=>c.name===n.name);return ce(de({},n),{selected:!!o})})),l=()=>{e("update:visible",!1)},r=()=>{const n=a.value.filter(o=>o.selected).map(o=>({name:o.name,address:o.address}));e("change",n),e("update:visible",!1)};return(n,o)=>(E(),S("div",It,[(E(!0),S(N,null,le(a.value,c=>(E(),S("div",{class:"item",key:c.name},[u("label",null,[ee(u("input",{type:"checkbox","onUpdate:modelValue":h=>c.selected=h},null,8,Dt),[[Pe,c.selected]]),u("span",null,I(c.name)+" <"+I(c.address)+">",1)])]))),128)),u("div",{class:"btns"},[u("button",{onClick:l},"close"),u("button",{onClick:r},"confirm")])]))}});var Tt=j(Ct,[["__scopeId","data-v-fad7a742"],["__file","SelectSchool.vue"]]);const xe=s=>(ye("data-v-3c5f93e5"),s=s(),be(),s),Pt={class:"box"},Rt=xe(()=>u("div",{class:"vfm-block-title"},"Schools",-1)),kt={class:"vfm-p"},qt=xe(()=>u("div",{class:"vfm-label"}," Selected Schools: ",-1)),Wt={class:"vfm-value"},Lt=W({setup(s){const e=p.getPathValueRef("schools"),t=D(!1),i=()=>{t.value=!0};return(a,l)=>(E(),S("div",Pt,[A(d(q),{form:d(p),name:"schools",rules:[{requiredLength:!0,message:"Must select one school"}]},{default:R(({field:r})=>{var n;return[Rt,u("div",kt,[qt,u("div",Wt,[ee(u("div",{class:"vfm-input",onClick:i},I(d(e).map(o=>o.name).join(",")),513),[[fe,!t.value]]),ee(u("div",{class:"vfm-error"},I((n=d(p).fieldError("schools"))==null?void 0:n.message),513),[[fe,!t.value]]),t.value?(E(),Re(Tt,k({key:0},r,{visible:t.value,"onUpdate:visible":l[0]||(l[0]=o=>t.value=o)}),null,16,["visible"])):H("",!0)])])]}),_:1},8,["form"])]))}});var Ut=j(Lt,[["__scopeId","data-v-3c5f93e5"],["__file","SchoolList.vue"]]);const Kt={class:"vfm"},Ot={class:"vfm-p"},Bt=u("div",{class:"vfm-label"},"User Name:",-1),Nt={class:"vfm-value"},jt={key:0,class:"vfm-error"},Mt={key:1,class:"vfm-error"},zt={class:"vfm-p"},Zt=u("div",{class:"vfm-label"},"Password:",-1),Ht={class:"vfm-value"},Gt={class:"vfm-error"},Jt={class:"vfm-p"},Qt=u("div",{class:"vfm-label"},"Password Confirm:",-1),Xt={class:"vfm-value"},Yt={class:"vfm-error"},es={class:"vfm-p"},ts=u("div",{class:"vfm-label"},"Tags:",-1),ss={class:"vfm-value"},is={class:"vfm-flex"},as={class:"vfm-flex-item-box"},ls={class:"vfm-flex-item-ins"},rs=["onClick"],ns={class:"vfm-error"},os=["onClick"],us={class:"vfm-p"},ds=u("div",{class:"vfm-label"},"Virtual Field (Tags):",-1),cs={class:"vfm-error"},fs={class:"vfm-p"},hs={key:0,class:"vfm-error",style:{width:"100%",textAlign:"center"}},vs=W({setup(s){const e=p.state,t=()=>{p.submit({onSuccess:a=>{alert(JSON.stringify(a,null,2))},onError:a=>{alert(a.message)}})};ae(()=>{p.mount()}),G(()=>{p.unmount()});const i=a=>(console.log("checkName"),new Promise(l=>{setTimeout(()=>{if(a==="test"){l("Username already exists");return}l("")},1e3)}));return(a,l)=>{var r;return E(),S("div",Kt,[u("div",Ot,[Bt,u("div",Nt,[A(d(q),{form:d(p),name:"username",rules:[{required:!0},{validator:n=>i(n),debounce:300}],"change-type":"ONINPUT"},{default:R(({field:n})=>{var o;return[u("input",k({class:"vfm-input",type:"text"},n),null,16),d(p).isValidating("username")?(E(),S("div",jt," loading... ")):(E(),S("div",Mt,I((o=d(p).fieldError("username"))==null?void 0:o.message),1))]}),_:1},8,["form","rules"])])]),u("div",zt,[Zt,u("div",Ht,[A(d(q),{form:d(p),name:"password",rules:[{required:!0,pattern:/[a-zA-Z0-9]{8,20}/}]},{default:R(({field:n})=>{var o;return[u("input",k({class:"vfm-input",type:"password"},n),null,16),u("div",Gt,I((o=d(p).fieldError("password"))==null?void 0:o.message),1)]}),_:1},8,["form"])])]),u("div",Jt,[Qt,u("div",Xt,[A(d(q),{form:d(p),name:"passwordConfirm",deps:()=>({password:d(e).values.password}),rules:[{required:!0,pattern:/[a-zA-Z0-9]{8,20}/},{validator:(n,{password:o})=>o&&n!==o?"The passwordConfirm must same as password":""}]},{default:R(({field:n})=>{var o;return[u("input",k({class:"vfm-input",type:"password"},n),null,16),u("div",Yt,I((o=d(p).fieldError("passwordConfirm"))==null?void 0:o.message),1)]}),_:1},8,["form","deps","rules"])])]),A(vt),u("div",es,[ts,u("div",ss,[A(d(it),{form:d(p),name:"tags"},{default:R(({append:n,remove:o,fields:c})=>[u("div",is,[(E(!0),S(N,null,le(c,(h,v)=>{var m;return E(),S("div",{class:"vfm-flex-item",key:h.id},[u("div",as,[u("div",ls,[A(d(q),{form:d(p),name:`tags.${v}`,rules:[{required:!0,message:"Required"}]},{default:R(({field:F})=>[u("input",k({class:"vfm-input",type:"text"},F),null,16)]),_:2},1032,["form","name"])]),u("div",{class:"vfm-action red",onClick:F=>o(h.id)},"-",8,rs)]),u("div",ns,I((m=d(p).fieldError(`tags.${v}`))==null?void 0:m.message),1)])}),128))]),u("div",{class:"vfm-action",onClick:h=>n("")},"+",8,os)]),_:1},8,["form"])])]),u("div",us,[A(d(st),{form:d(p),name:"tags",value:()=>(d(p).state.values.tags.length,d(p).state.values.tags),rules:[{requiredLength:!0,message:"must have one tag"}]},null,8,["form","value"]),ds,u("div",cs,I((r=d(p).virtualFieldError("tags"))==null?void 0:r.message),1)]),A(wt),A(Ut),u("div",fs,[u("button",{class:"vfm-button",onClick:t},"Submit"),d(p).state.isError?(E(),S("div",hs," Have error, cannot submit ")):H("",!0)])])}}});var _s=j(vs,[["__file","BaseForm.vue"]]);export{_s as default};
